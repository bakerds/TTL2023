{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Welcome to MkDocs","text":"<p>For full documentation visit mkdocs.org.</p>"},{"location":"#commands","title":"Commands","text":"<ul> <li><code>mkdocs new [dir-name]</code> - Create a new project.</li> <li><code>mkdocs serve</code> - Start the live-reloading docs server.</li> <li><code>mkdocs build</code> - Build the documentation site.</li> <li><code>mkdocs -h</code> - Print help message and exit.</li> </ul>"},{"location":"#project-layout","title":"Project layout","text":"<pre><code>mkdocs.yml    # The configuration file.\ndocs/\n    index.md  # The documentation homepage.\n    ...       # Other markdown pages, images and other files.\n</code></pre>"},{"location":"security/","title":"Routing Security \u2014 BGP, IRR, and RPKI","text":""},{"location":"security/#important-terms","title":"Important terms","text":"<ul> <li>Router: a device that connects multiple networks at layer 3</li> <li>Autonomous System (AS): a network or group of networks that belongs to a single organization and is connected to the Internet</li> <li>Autonomous System Number (ASN): a 16-bit or 32-bit number that identifies an autonomous system</li> <li>Border Gateway Protocol (BGP): the routing protocol used by Internet routers to exchange routing information between autonomous systems</li> <li>Regional Internet Registry (RIR): an organization that manages the allocation and registration of Internet number resources such as IPv4 and IPv6 address space and AS numbers within a region of the world</li> <li>American Registry for Internet Numbers (ARIN): the regional Internet registry for the United States, Canada, and many Caribbean and North Atlantic islands</li> <li>Internet Routing Registry (IRR): a public database of routing information that can be used for matching networks to origin ASNs</li> <li>Resource Public Key Infrastructure (RPKI): a cryptographic method of signing records that associate a BGP route announcement with the correct originating AS number</li> </ul>"},{"location":"security/#border-gateway-protocol-the-routing-protocol-of-the-internet","title":"Border Gateway Protocol: the routing protocol of the Internet","text":"<ul> <li>BGP is the routing protocol used by all Internet service providers and many of their customers</li> <li>BGP routers may originate routes or prefixes for their own AS, or they may announce routes learned from another AS they are connected to</li> <li>An ISP router typically has the full Internet routing table in memory and knows one or more paths to every prefix announced to the Internet</li> <li>When there are multiple paths to a destination, the router uses a calculation based on BGP route attributes and locally administered policy to determine the best route</li> </ul>"},{"location":"security/#what-are-irr-and-rpki-for","title":"What are IRR and RPKI for?","text":"<ul> <li>IRR serves three purposes:<ul> <li>provides a means to publish your own routing intentions</li> <li>provides the information necessary to build route filters</li> <li>aids in troubleshooting and network management by providing information about other networks</li> </ul> </li> <li>RPKI serves two purposes:<ul> <li>provides a cryptographic means to publish your own routing intentions</li> <li>provides a cryptographic means for validating routes you receive</li> </ul> </li> </ul>"},{"location":"security/#why-are-route-filtering-and-validation-important","title":"Why are route filtering and validation important?","text":"<ul> <li>The early Internet was built on trust between the connected networks. BGP has no built-in security, so any ASN can announce any prefix!</li> <li>Network operators are generally well-behaved and announce the correct routes</li> <li>Now the Internet has 5 billion users (about 70,000 active ASNs)</li> <li>Routing issues can cause financial losses, compromise of data, or even loss of life!</li> <li>Money and political gain are powerful incentives for some to tamper with Internet routing<ul> <li>Hackers and scammers</li> <li>Unfriendly governments or adversaries</li> </ul> </li> <li>Mistakes happen \u2014 misconfigurations or software bugs can cause route leaks, loops, and traffic loss</li> <li>Many providers use IRR to build filters. You must maintain up-to-date IRR entries to ensure all backbone carriers will carry your routes!<ul> <li>\"But I don't have IRR, and my providers are carrying my routes just fine!\"</li> <li>Most likely one or more of your providers has created IRR records on your behalf, a practice known as \"proxy registration\". You should maintain your own IRR records rather than rely on a carrier to get them right. The records may have been created be a carrier you no longer use.</li> </ul> </li> <li>Many providers filter RPKI invalid routes but still accept RPKI unknown routes. You get the most protection against route hijacking by signing your route advertisements with RPKI so they are RPKI valid.</li> </ul>"},{"location":"security/#irr-internet-routing-registry","title":"IRR \u2014 Internet Routing Registry","text":"<p>The IRR is not a single database \u2014 there are several routing registries to choose from: - ARIN (most likely choice) - rr.arin.net - RADb (pay to list) - whois.radb.net - Level3 - rr.level3.net - NTT - rr.ntt.net</p> <p>Most IRR databases mirror the others.</p> <p>The IRR can be queried using whois: <code>whois -h rr.arin.net AS14773</code></p> <p>If you don't have a whois client (Windows :unamused:), you can query from your web browser at https://www.radb.net/query.</p> <p>(If you're on Ubuntu/Debian, <code>sudo apt install whois</code>)</p>"},{"location":"security/#using-the-irr","title":"Using the IRR","text":""},{"location":"security/#publishing-routing-information","title":"Publishing routing information","text":""},{"location":"security/#object-types","title":"Object types","text":"<ul> <li>route/route6: describes a prefix that you will originate<ul> <li>Maintained By: links the record to your ARIN organization</li> <li>Prefix: the prefix you plan to announce</li> <li>Origin: the ASN that will originate the prefix</li> <li>Description: your organization's name and address, and any additional information about the prefix</li> </ul> </li> <li>as-set: specifies a set of Autonomous System Numbers (ASNs) through which traffic can be routed. Useful if you have downstream ASNs (customers)<ul> <li>AS Set Name: the unique name of the as-set</li> <li>Description: your organization's name and address, and any additional information about the as-set</li> <li>Members: ASNs and as-set names that are included in the as-set</li> </ul> </li> <li>aut-num: specifies an ASN and its routing policies<ul> <li>Maintained By: links the record to your ARIN organization</li> <li>ASN: the ASN described by this object</li> <li>AS Name: a human-readable nickname for the ASN</li> <li>Description: your organization's name and address, and any additional information about the autonomous system</li> <li>Routing Policy Specifications:<ul> <li>Import: IPv4 import policy</li> <li>Export: IPv4 export policy</li> <li>Default: IPv4 default routing policy</li> <li>Mp Import: multi-protocol import policy (multi-protocol support added later for IPv6)</li> <li>Mp Export: multi-protocol export policy</li> <li>Mp Default: multi-protocol default routing policy</li> <li>Remarks: additional comments or notes visible to the public</li> </ul> </li> </ul> </li> <li>route-set: a set of IPv4 prefixes, IPv6 prefixes, and other route-sets that can be used in aut-num policy specifications<ul> <li>Route Set Name: the unique name of the route-set</li> <li>Description: your organization's name and address, and any additional information about the route-set</li> <li>Members: a list of IPv4 prefixes or route-sets to include</li> <li>Mp Members: a list of IPv6 prefixes or route-sets to include</li> <li>Members by Reference: a list of organizations whose route objects should be included in the route-set</li> <li>Remarks: additional comments or notes visible to the public</li> </ul> </li> </ul>"},{"location":"security/#example-objects","title":"Example objects","text":""},{"location":"security/#aut-num","title":"aut-num","text":"<p>IU13 WAN</p> <pre><code>$ whois -h rr.arin.net AS14773\naut-num:        AS14773\nas-name:        LANLEB-IU13\ndescr:          Lancaster-Lebanon IU13 WAN Consortium\n                1020 New Holland Avenue\n                Lancaster PA 17601\n                United States\nmember-of:      AS-IU13WAN\nmp-export:      afi any.unicast to AS-ANY announce AS-IU13WAN\nadmin-c:        NETWO9356-ARIN\ntech-c:         NETWO9356-ARIN\nmnt-by:         MNT-LLIU1\ncreated:        2023-02-02T18:08:17Z\nlast-modified:  2023-02-02T18:08:17Z\nsource:         ARIN\n</code></pre> <p>Hempfield School District</p> <pre><code>$ whois -h rr.arin.net AS395182\naut-num:        AS395182\nas-name:        HEMPFIELD-SD\ndescr:          200 Church Street\n                Landisville PA 17538\n                United States\nadmin-c:        GRAHA156-ARIN\ntech-c:         FARME185-ARIN\ntech-c:         GRAHA156-ARIN\ntech-c:         LICHT37-ARIN\nmnt-by:         MNT-HSD-37\ncreated:        2022-03-05T12:49:41Z\nlast-modified:  2022-03-05T12:49:41Z\nsource:         ARIN\n</code></pre>"},{"location":"security/#as-set","title":"as-set","text":"<p>IU13 WAN</p> <pre><code>$ whois -h rr.arin.net AS-IU13WAN\nas-set:         AS-IU13WAN\ndescr:          Lancaster-Lebanon IU13 WAN Consortium\n                1020 New Holland Avenue\n                Lancaster PA 17601\n                United States\nmembers:        AS14773,AS395182,AS394781,AS398574\nadmin-c:        NETWO9356-ARIN\ntech-c:         NETWO9356-ARIN\nmnt-by:         MNT-LLIU1\ncreated:        2022-03-07T21:58:53Z\nlast-modified:  2022-06-01T15:09:59Z\nsource:         ARIN\n</code></pre>"},{"location":"security/#routeroute6","title":"route/route6","text":"<pre><code>$ whois -h rr.arin.net 206.82.16.0/20\nroute:          206.82.16.0/20\norigin:         AS14773\ndescr:          Lancaster-Lebanon IU13 WAN Consortium\n                1020 New Holland Avenue\n                Lancaster PA 17601\n                United States\nadmin-c:        NETWO9356-ARIN\ntech-c:         NETWO9356-ARIN\nmnt-by:         MNT-LLIU1\ncreated:        2022-03-07T22:06:29Z\nlast-modified:  2022-03-07T22:06:29Z\nsource:         ARIN\n\n$ whois -h rr.arin.net 2620:1d5::/32\nroute6:         2620:1d5::/32\norigin:         AS14773\ndescr:          Lancaster-Lebanon IU13 WAN Consortium\n                1020 New Holland Avenue\n                Lancaster PA 17601\n                United States\nadmin-c:        NETWO9356-ARIN\ntech-c:         NETWO9356-ARIN\nmnt-by:         MNT-LLIU1\ncreated:        2022-10-03T15:48:56Z\nlast-modified:  2022-10-03T15:48:56Z\nsource:         ARIN\n</code></pre>"},{"location":"security/#example-checking-the-state-of-irr","title":"Example: Checking the state of IRR","text":"<p>Red Lion Area School District</p> <p>Let's find out what IP ranges they have been assigned by ARIN:</p> <pre><code>$ whois -h whois.arin.net \"o ! &gt;  RLASD\" | grep NET\nRed Lion Area School District RLASD-ISP (NET-192-133-103-0-1) 192.133.103.0 - 192.133.103.255\nRed Lion Area School District RED-LION-AREA-SCHOOL-DISTRICT (NET6-2620-73-A000-1) 2620:73:A000:: - 2620:73:A000:FFFF:FFFF:FFFF:FFFF:FFFF\n</code></pre> <p>We found these prefixes: - 192.133.103.0/24 - 2620:73:a000::/48</p> <p>Let's query the IRR for 192.133.103.0/24:</p> <pre><code>$ whois -h rr.arin.net 192.133.103.0/24\n%  No entries found for the selected source(s).\n</code></pre> <p>Nothing in ARIN... let's try RADb:</p> <pre><code>$ whois -h whois.radb.net 192.133.103.0/24\nroute:      192.133.103.0/24\ndescr:      Zito Networks\norigin:     AS397737\nmnt-by:     MAINT-AS26801\nchanged:    skyler.blumer@zitomedia.com 20220330\nsource:     RADB\n</code></pre> <p><code>descr: Zito Networks</code> is clearly not accurate, since ARIN says the prefix is allocated to Red Lion! Notice that the maintainer is Zito as well. This is an example of \"proxy registration\", where a carrier creates IRR on behalf of their customer to make sure the customer's route is accepted upstream.</p> <p>Red Lion has two ISPs, Zito and FirstLight. What would happen if Red Lion's contract with Zito ended and Zito chose to clean up their IRR records? FirstLight might still carry Red Lion's prefix, but their upstream carriers would likely begin filtering it, causing bad routing or even service disruption for the school district!</p> <p>Don't worry, you don't have to check every IRR database individually!</p> <p>IRR Explorer queries all of the IRR databases and displays a column for each database a prefix appears in, with a link to view the underlying whois query and response.</p> <p>Red Lion: https://irrexplorer.nlnog.net/asn/AS397737</p> <p>Here we see that Red Lion's prefix appears only in RADb, the same record we discovered above.</p> <p> </p> <p>IU13: https://irrexplorer.nlnog.net/asn/AS14773</p> <p>Notice the ARIN entries maintained by IU13, and RADb entries created in the past by Comcast and Zito. As long as the <code>origin: AS14773</code> is correct, it is ok to have those duplicate records. However, if a provider has listed your prefix with a different origin ASN, you should contact the IRR database operator and request that the record be removed (after you publish your own correct IRR records!)</p>"},{"location":"security/#example-publishing-irr-records","title":"Example: Publishing IRR Records","text":"<p>Red Lion should create the following IRR records in the ARIN Dashboard:</p> <p>aut-num</p> <pre><code>aut-num:        AS397737\nas-name:        RLASD\ndescr:          Red Lion Area School District\n                696 Delta Rd\n                Red Lion PA 17356\n                United States\nmp-export:      afi any.unicast to AS-ANY announce AS397737\nadmin-c:        BEARD140-ARIN\ntech-c:         BEARD140-ARIN\nmnt-by:         MNT-RLASD\n</code></pre> <p>route</p> <pre><code>route:          206.82.16.0/20\norigin:         AS397737\ndescr:          Red Lion Area School District\n                696 Delta Rd\n                Red Lion PA 17356\n                United States\nadmin-c:        BEARD140-ARIN\ntech-c:         BEARD140-ARIN\nmnt-by:         MNT-RLASD\n</code></pre> <p>ARIN Dashboard Preview</p> <p>https://account.arin.net/public/secure/dashboard</p> <p> </p>"},{"location":"security/#building-route-filters-using-irr","title":"Building route filters using IRR","text":"<p>For customer networks (like school districts), it is important to publish your own IRR objects. Filtering received routes using IRR is only necessary when you have customer networks or non-transit peerings. Do not try to filter routes you receive from a full transit provider!</p>"},{"location":"security/#bgpq3","title":"bgpq3","text":"<p>bgpq3 is a utility used to generate router configurations (prefix-lists, extended access-lists, policy-statement terms and as-path lists) based on IRR data.</p> <p>(If you're on Ubuntu/Debian, <code>sudo apt install bgpq3</code>)</p> <p>bgpq3 can generate output formatted for JunOS, IOS, BIRD, generic JSON, and more. (bgpq3 man page)</p>"},{"location":"security/#examples-junos","title":"Examples (JunOS)","text":"<p>If you have customer AS395182 (Hempfield School District):</p> <pre><code>$ bgpq3 -Jz -4 -l Cust-Hempfield-v4 AS395182\npolicy-options {\nreplace:\n  route-filter-list Cust-Hempfield-v4 {\n    67.199.243.0/24 exact;\n  }\n}\n\n$ bgpq3 -Jz -6 -l Cust-Hempfield-v4 AS395182\npolicy-options {\nreplace:\n  route-filter-list Cust-Hempfield-v4 {\n    2620:120:c000::/40 exact;\n  }\n}\n</code></pre> <p>If you have peer AS20940 (Akamai \u2014 as-set AS-AKAMAI):</p> <pre><code>$ bgpq3 -Jz -A -4 -l Peer-Akamai-v4 AS-AKAMAI\npolicy-options {\nreplace:\n  route-filter-list Peer-Akamai-v4 {\n    2.16.0.0/13 exact;\n    2.16.0.0/22 prefix-length-range /24-/24;\n    2.16.4.0/22 prefix-length-range /23-/23;\n\n    ( 6449 lines omitted )\n\n    221.111.224.0/26 exact;\n  }\n}\n\n$ bgpq3 -Jz -A -6 -l Peer-Akamai-v6 AS-AKAMAI\npolicy-options {\nreplace:\n  route-filter-list Peer-Akamai-v6 {\n    2001:218:3003:100::/56 exact;\n    2001:218:3003:200::/56 exact;\n    2001:218:3004::/48 exact;\n\n    ( 2820 lines omitted )\n\n    2c0f:fd58:9::/64 exact;\n  }\n}\n\n</code></pre> <ul> <li>Config automation is strongly recommended!<ul> <li>For networks with more than a few customers or peers, config automation should be used to keep route filters up-to-date</li> </ul> </li> <li>Watch out for filter list size!<ul> <li>Your router will likely crash and burn if you try to use a list that's too large</li> <li>For example, AS-HURRICANE, unsummarized, has over 900,000 IPv4 route entries and over 200,000 IPv6 route entries! Few, if any, hardware routers will handle lists that large</li> <li>Route server software such as BIRD can handle large filter sets more easily and are commonly deployed in IX peering environments</li> <li>Again, do not try to filter full transit providers! Filter customers and peers only.</li> </ul> </li> </ul>"},{"location":"security/#problems-with-irr","title":"Problems with IRR","text":"<ul> <li>IRR data is incomplete \u2014 not every organization has published IRR</li> <li>IRR data may become outdated and inaccurate over time if not actively maintained</li> <li>Not every network uses IRR to filter routes</li> <li>There is no verification of IP or ASN ownership, so untrue records could be created in the IRR in an attempt to permit BGP hijacks rather than prevent them</li> </ul>"},{"location":"security/#questions-about-irr","title":"Questions about IRR?","text":""},{"location":"security/#rpki-resource-public-key-infrastructure","title":"RPKI \u2014 Resource Public Key Infrastructure","text":"<ul> <li>RPKI uses cryptographically verifiable statements to ensure that Internet number resources are certifiably linked to the stated holders of those resources</li> <li>Each Regional Internet Registry (RIR) is responsible for providing resource certificates to resource holders (customer organizations)</li> <li>The resource certificate verifies the IP resources allocated to the organization</li> <li>Resource certificates are available only to organizations who have contractual relationships with one or more RIRs and have been allocated number resources (IP addresses)</li> </ul> <p>RPKI Terminology - Resource Certificate: A certificate issued by an RIR that lists a the Internet number resources (IPv4 addresses, IPv6 addresses, and Autonomous System Numbers) that are associated with an organization - Route Origin Authorization (ROA): A cryptographically signed object that states which Autonomous System (AS) is authorized to originate a particular IP address prefix or set of prefixes     - ROA Name: a descriptive name for the ROA     - Origin AS: the ASN that will originate the prefix     - Start Date: the first date your ROA can be considered valid     - End Date: the last date your ROA can be considered valid     - Prefixes: a list of prefixes to be included in the ROA - Route Origin Validation: Comparing route announcements to ROAs to determine whether a route announcement is valid     - Valid: a ROA exists for the prefix, and the origin AS of the route announcement matches the origin AS specified in the ROA (the announcement should be accepted)     - Invalid: a ROA exists for the prefix, but the origin AS of the announcement does not match the origin AS specified in the ROA (the announcement should be rejected)     - Not Found: no ROA exists for the prefix in the announcement (the announcement is usually accepted)</p>"},{"location":"security/#viewing-rpki-records","title":"Viewing RPKI records","text":"<p>RPKI records are hosted in public repositories. The easiest way to query them is using a web service such as the Cloudflare RPKI Portal or the RIPE Routinator</p> <p>Example ROAs</p> <p>206.82.16.0/20</p> <p></p> <p>A ROA exists for 206.82.16.0/20 to be announced by AS14773. The ROA is signed by the ARIN Trust Anchor because the IP prefix was assigned by ARIN.</p>"},{"location":"security/#rpki-models","title":"RPKI Models","text":"<ul> <li>Hosted RPKI \u2014 Recommended<ul> <li>Each RIR hosts a Certificate Authority (CA) and signs Route Origin Authorizations (ROAs) for resources within the RIR region</li> <li>Downstream organizations must have their upstream provider submit ROAs on their behalf</li> <li>Infrastructure is maintained by the RIR</li> </ul> </li> <li>Delegated RPKI<ul> <li>You can run your own RPKI Certification Authority (CA), manage your Route Origin Authorizations (ROAs) and publish them in your own repository</li> <li>You can delegate subordinate CAs to downstream organization</li> <li>Infrastructure is maintained by the organization</li> </ul> </li> </ul> <p>ROAs cannot be created by third parties! (unlike IRR proxy registration)</p>"},{"location":"security/#using-the-rpki","title":"Using the RPKI","text":""},{"location":"security/#publishing-routing-information-arin-hosted-rpki","title":"Publishing routing information (ARIN Hosted RPKI)","text":"<p>Official documentation: https://www.arin.net/resources/manage/rpki/hosted/</p> <p>You can preview this process using the ARIN Operational Test and Evaluation environment (OT&amp;E) before making changes to production! Log in at https://www.ote.arin.net</p>"},{"location":"security/#request-a-resource-certificate","title":"Request a resource certificate","text":"<ul> <li>Create an RSA keypair to use to sign ROAs (store private key in a secure location!)<ul> <li><code>OpenSSL&gt; genrsa -out orgkeypair.pem 2048</code></li> </ul> </li> <li>Extract public key<ul> <li><code>OpenSSL&gt; rsa -in orgkeypair.pem -pubout -outform PEM -out org_pubkey.pem</code></li> </ul> </li> <li>Request a resource certificate from ARIN<ul> <li>Log in to ARIN Online and navigate to Routing Security &gt; RPKI</li> <li>Click \"Sign up for RPKI\" for your organization </li> <li>Choose \"Configure Hosted\" </li> <li>Paste your public key that you created into the Public Key field </li> <li>Submit the form and wait for ARIN to email you saying they have issue the resource certificate <ul> <li>If you are working in the test environment (OT&amp;E), you should open a ticket in the production environment referencing your OT&amp;E ticket number, as OT&amp;E tickets are not monitored regularly.</li> </ul> </li> </ul> </li> </ul>"},{"location":"security/#create-roas","title":"Create ROAs","text":"<ul> <li> <p>Create a ROA for each prefix you advertise in BGP</p> <ul> <li>Do not create ROAs for prefixes you do not plan to advertise!<ul> <li>This creates an opportunity for a BGP hijack</li> </ul> </li> <li>Do not use the max-length field to permit more-specific advertisements!<ul> <li>This creates an opportunity for a BGP hijack</li> </ul> </li> <li>Do not include multiple prefixes in a single ROA<ul> <li>It is not possible to remove a prefix from an existing ROA</li> <li>If you need to remove a prefix from a ROA with multiple prefixes, you would need to delete the entire ROA and recreate it</li> <li>Best practice is to create your ROAs with exactly one prefix each</li> </ul> </li> <li>When creating a ROA in ARIN, you need to provide your private key<ul> <li>The private key is used client-side to sign the ROA, which is then submitted to ARIN</li> <li>The private key is not submitted to ARIN, and should never be shared or uploaded anywhere</li> <li>If you lose your private key, you will need to submit a ticket to ARIN to have your RPKI records deleted and start over with a new resource certificate</li> </ul> </li> <li>Enter the required information, attach your private key, and click Next Step  </li> <li>The web page will generate the ROA signed by your private key and then provide a validation screen where you can confirm or cancel ROA creation</li> </ul> </li> <li> <p>Monitor ROAs and resource certificate for expiration</p> <ul> <li>ARIN does not currently have a means to automatically renew expiring ROAs, but will likely release one in the future</li> </ul> </li> </ul>"},{"location":"security/#validating-received-routes","title":"Validating received routes","text":"<p>RPKI validation is appropriate on BGP sessions where you do not accept a default route. It should be used with customers, non-transit peerings, and full transit providers supplying the full DFZ routing table. If you accept a default route from any neighbor, RPKI validation serves no purpose.</p>"},{"location":"security/#feeding-rpki-data-to-routers","title":"Feeding RPKI data to routers","text":"<p>Relying Party RPKI data lives in various repositories \u2014 one for each of the RIR Trust Anchors. The repositories and delegated sub-repositories (for organizations that choose to self-host delegated RPKI) must be fetched by a Relying Party software. When all of the data has been retrieved, the Relying Party software parses it into a list of ROAs.</p> <p>RPKI-to-Router (RTR) Protocol Once the data has been processed by a Relying Party, then it can be sent to a router using the RPKI-to-Router (RTR) protocol, standardized in RFC 6810 and RFC 8210. Once the router is receiving RPKI data, you can apply policy actions based on validation state.</p>"},{"location":"security/#relying-party","title":"Relying Party","text":"<p>Cloudflare has released a Relying Party software called OctoRPKI. OctoRPKI powers the Cloudflare RPKI Portal and generates a json file of all ROAs, hosted in Cloudflare's CDN (https://rpki.cloudflare.com/rpki.json \u2014 warning: may crash your browser if you try to view it).</p> <p>Other Relying Party software options include Routinator and FORT Validator. Both include an RPKI-to-Router (RTR) server.</p>"},{"location":"security/#rtr-server","title":"RTR Server","text":"<p>Cloudflare has released an RTR server written in Go called GoRTR. GoRTR consumes a json file of ROAs produced by OctoRPKI or a compatible validator. By default, it uses the rpki.json hosted by Cloudflare as its input.</p> <p>Cloudflare also provides a public RTR server at rtr.rpki.cloudflare.com:8282, however it is not well documented and should not be your only RTR server, should you choose to use it at all.</p> <p>IU13 maintains two GoRTR servers which are used by our Internet routers and are available for WAN members use.</p>"},{"location":"security/#router-configuration","title":"Router Configuration","text":"<p>Juniper, Cisco, Arista, BIRD, and several other types of routers have native support for the RTR protocol.</p>"},{"location":"security/#junos-example","title":"JunOS Example","text":"<p>Configuring and verifying RTR functionality</p> <pre><code>routing-options {\n    validation {\n        group RPKI {\n            max-sessions 4;\n            /* rtr.rpki.cloudflare.com */\n            session 172.65.0.2 {\n                preference 80;\n                port 8282;\n            }\n            session 2606:4700:60::2 {\n                preference 90;\n                port 8282;\n            }\n            /* IU13 WAN GoRTR servers */\n            session 2620:1d5:xyz::123 {\n                port 8282;\n            }\n            session 2620:1d5:xyz::abc {\n                port 8282;\n            }\n        }\n    }\n}\n</code></pre> <pre><code>set routing-options validation group RPKI max-sessions 4\nset routing-options validation group RPKI session 172.65.0.2 preference 80\nset routing-options validation group RPKI session 172.65.0.2 port 8282\nset routing-options validation group RPKI session 2606:4700:60::2 preference 90\nset routing-options validation group RPKI session 2606:4700:60::2 port 8282\nset routing-options validation group RPKI session 2620:1d5:xyz::123 port 8282\nset routing-options validation group RPKI session 2620:1d5:xyz::abc port 8282\n</code></pre> <pre><code>JunOS&gt; show validation session\nSession                 State   Flaps       Uptime   #IPv4/IPv6 records\n172.65.0.2              Up          0  2d 00:06:23   349613/74477\n2606:4700:60::2         Up          1  1d 08:48:00   349615/74476\n2620:1d5:xyz::123       Up          0  1d 23:29:27   349613/74477\n2620:1d5:xyz::abc       Up          0  1d 23:28:51   349615/74476\n</code></pre> <pre><code>JunOS&gt; show validation database\nRV database for instance master\n\nPrefix          Origin-AS Session                State   Mismatch\n1.0.0.0/24-24       13335 172.65.0.2             valid\n1.0.0.0/24-24       13335 2606:4700:60::2        valid\n1.0.0.0/24-24       13335 2620:1d5:xyz::123      valid\n1.0.0.0/24-24       13335 2620:1d5:xyz::abc      valid\n1.0.4.0/22-22       38803 172.65.0.2             valid\n1.0.4.0/22-22       38803 2606:4700:60::2        valid\n1.0.4.0/22-22       38803 2620:1d5:xyz::123      valid\n1.0.4.0/22-22       38803 2620:1d5:xyz::abc      valid\n...\n</code></pre> <p>Using RPKI validation in route policy</p> <pre><code>term RPKI-Valid {\n    from {\n        protocol bgp;\n        validation-database valid;\n    }\n    then {\n        validation-state valid;\n        next term;\n    }\n}\nterm RPKI-Invalid {\n    from {\n        protocol bgp;\n        validation-database invalid;\n    }\n    then {\n        validation-state invalid;\n        reject;\n    }\n}\n</code></pre> <pre><code>set policy-options policy-statement Import-from-Transit term RPKI-Valid from protocol bgp\nset policy-options policy-statement Import-from-Transit term RPKI-Valid from validation-database valid\nset policy-options policy-statement Import-from-Transit term RPKI-Valid then validation-state valid\nset policy-options policy-statement Import-from-Transit term RPKI-Valid then next term\n\nset policy-options policy-statement Import-from-Transit term RPKI-Invalid from protocol bgp\nset policy-options policy-statement Import-from-Transit term RPKI-Invalid from validation-database invalid\nset policy-options policy-statement Import-from-Transit term RPKI-Invalid then validation-state invalid\nset policy-options policy-statement Import-from-Transit term RPKI-Invalid then reject\n</code></pre>"}]}